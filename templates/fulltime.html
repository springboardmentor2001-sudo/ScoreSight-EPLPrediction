<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>EPL Match Predictor</title>
<style>
    body {
        font-family: "Poppins", sans-serif;
        background: linear-gradient(135deg, #001f3f, #004080);
        color: #fff;
        margin: 0;
        padding: 0;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
    }

    header {
        background: rgba(0, 0, 0, 0.3);
        padding: 15px 40px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        backdrop-filter: blur(5px);
        border-bottom: 1px solid rgba(255,255,255,0.2);
    }

    header h1 {
        margin: 0;
        font-size: 26px;
        color: #00ffcc;
        letter-spacing: 1px;
    }

    nav a {
        color: #fff;
        text-decoration: none;
        margin-left: 25px;
        font-size: 16px;
        transition: 0.3s;
    }

    nav a:hover {
        color: #00ffcc;
    }

    main {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        gap: 40px;
        padding: 40px;
    }

    .frame {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(12px);
        border-radius: 20px;
        box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        padding: 30px;
        width: 45%;
        min-height: 550px;
        overflow-y: auto;
        animation: fadeIn 0.8s ease-in-out;
        transition: transform 0.3s;
    }

    .frame:hover {
        transform: scale(1.02);
    }

    @keyframes fadeIn {
        from {opacity: 0; transform: translateY(20px);}
        to {opacity: 1; transform: translateY(0);}
    }

    .frame h2 {
        text-align: center;
        margin-bottom: 20px;
        color: #00ffcc;
        border-bottom: 2px solid #00ffcc;
        display: inline-block;
        padding-bottom: 5px;
    }

    label {
        display: block;
        margin-bottom: 6px;
        color: #eee;
        text-align: left;
        font-weight: 500;
    }

    select, input {
        width: 100%;
        padding: 10px;
        border-radius: 8px;
        border: none;
        font-size: 14px;
        margin-bottom: 15px;
        box-sizing: border-box;
        background-color: rgba(255,255,255,0.9);
        color: #000;
    }

    .grid-3 {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 25px;
    }

    .grid-stats div {
        display: flex;
        flex-direction: column;
    }

    button {
        background-color: #00bfff;
        color: white;
        border: none;
        padding: 14px;
        border-radius: 10px;
        cursor: pointer;
        width: 100%;
        font-size: 17px;
        transition: 0.3s;
        margin-top: 15px;
    }

    button:hover {
        background-color: #00a0cc;
        box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
    }

    .result-box p {
        margin: 9.5px 0;
        font-size: 14px;
    }

    .pred {
        font-size: 20px;
        font-weight: bold;
        color: #00ffcc;
    }

    .probabilities {
        margin-top: 20px;
    }

    .prob-item {
        display: flex;
        justify-content: space-between;
        margin: 6px 0;
        font-size: 15px;
    }

    .prob-bar {
        height: 10px;
        border-radius: 5px;
        background: #00bfff;
        margin-top: 4px;
    }

    footer {
        text-align: center;
        padding: 15px 0;
        background: rgba(0, 0, 0, 0.3);
        color: #ccc;
        font-size: 14px;
        border-top: 1px solid rgba(255,255,255,0.2);
    }

    @media (max-width: 950px) {
        main {
            flex-direction: column;
            align-items: center;
        }
        .frame {
            width: 90%;
        }
    }
</style>
</head>
<body>

<header>
    <h1>EPL Match Predictor</h1>
    <nav>
        <a href="{{ url_for('home') }}">Home</a>
        <a href="{{ url_for('predict') }}">Predict</a>
        <a href="{{ url_for('stats') }}">Stats</a>
        <a href="{{ url_for('live') }}">Live</a>
        <a href="{{ url_for('chatbot') }}">AI Chat</a>
        <a href="{{ url_for('logout') }}">Logout</a>
    </nav>
</header>

<main>
    <!-- Left Frame: User Input -->
    <div class="frame">
        <h2>Enter Match Details</h2>
        <form action="/predict/fulltime" method="POST">
            <div class="grid-3">
                <div>
                    <label>Home Team:</label>
                    <select name="HomeTeam" required>
                        <option value="">Select Home Team</option>
                        {% for team in teams %}
                        <option value="{{ team }}">{{ team }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div>
                    <label>Away Team:</label>
                    <select name="AwayTeam" required>
                        <option value="">Select Away Team</option>
                        {% for team in teams %}
                        <option value="{{ team }}">{{ team }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div>
                    <label>Match Date:</label>
                    <input type="date" name="Date" required>
                </div>
            </div>

            <h3>Team Performance Stats</h3>
            <div class="grid-3 grid-stats">
                <div>
                    <label>Home Shots:</label><input type="number" name="HS" required>
                    <label>Away Shots:</label><input type="number" name="AS" required>
                    <label>Home Shots on Target:</label><input type="number" name="HST" required>
                    <label>Away Shots on Target:</label><input type="number" name="AST" required>
                </div>
                <div>
                    <label>Home Corners:</label><input type="number" name="HC" required>
                    <label>Away Corners:</label><input type="number" name="AC" required>
                    <label>Home Fouls:</label><input type="number" name="HF" required>
                    <label>Away Fouls:</label><input type="number" name="AF" required>
                </div>
                <div>
                    <label>Home Yellow Cards:</label><input type="number" name="HY" required>
                    <label>Away Yellow Cards:</label><input type="number" name="AY" required>
                    <label>Home Red Cards:</label><input type="number" name="HR" required>
                    <label>Away Red Cards:</label><input type="number" name="AR" required>
                </div>
            </div>
            <button type="submit">Predict Match Result</button>
        </form>
    </div>

    <!-- Right Frame: Result -->
    <!-- Right Frame: Result -->
<div class="frame result-box">
    <h2>Prediction Result</h2>
    {% if prediction %}
    <p><strong>Match:</strong> {{ home_team }} vs {{ away_team }}</p>
    <p><strong>Date:</strong> {{ date }}</p>
    <p class="pred">Predicted Outcome: {{ prediction }}</p>

    <div class="probabilities">
        <h4>Prediction Confidence:</h4>
        {% for outcome, prob in probabilities.items() %}
            <div class="prob-item">
                <span>{{ outcome }}</span>
                <span>{{ prob }}%</span>
            </div>
            <div class="prob-bar" style="width: {{ prob }}%; background-color: {% if outcome == prediction %}#00ffcc{% else %}#1e90ff{% endif %};"></div>
        {% endfor %}
    </div>

    <h4 style="margin-top:25px; text-align:center; color:#00ffcc;">Confidence Chart</h4>
<div style="display: flex; justify-content: center; align-items: center; gap: 20px; flex-wrap: wrap;">
    <div style="width: 180px; max-width: 200px;">
        <canvas id="confidenceChart"></canvas>
    </div>
    <div id="chartLegend" style="font-size: 14px; color: #fff;"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const ctx = document.getElementById('confidenceChart').getContext('2d');
    const chartData = {
        labels: [{% for outcome in probabilities.keys() %}"{{ outcome }}",{% endfor %}],
        datasets: [{
            label: 'Prediction Confidence (%)',
            data: [{% for prob in probabilities.values() %}{{ prob }},{% endfor %}],
            backgroundColor: [
                '#00ffcc',
                '#1e90ff',
                '#ffcc00'
            ],
            borderColor: 'rgba(255, 255, 255, 0.5)',
            borderWidth: 2
        }]
    };

    const confidenceChart = new Chart(ctx, {
        type: 'pie',
        data: chartData,
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: { display: false } // hide default legend
            }
        }
    });

    // Custom legend on the right
    const legendContainer = document.getElementById('chartLegend');
    const legendHTML = confidenceChart.data.labels.map((label, i) => `
        <div style="display:flex; align-items:center; margin-bottom:6px;">
            <div style="width:14px; height:14px; background:${confidenceChart.data.datasets[0].backgroundColor[i]}; border-radius:3px; margin-right:8px;"></div>
            <span>${label}: ${confidenceChart.data.datasets[0].data[i]}%</span>
        </div>
    `).join('');
    legendContainer.innerHTML = legendHTML;
</script>

    {% else %}
    <p style="text-align:center; color:#ccc;">No prediction yet. Fill out the match details to see the result here.</p>
    {% endif %}
</div>
</main>

<footer>
    &copy; 2025 EPL Match Predictor
</footer>

</body>
</html>
